{
  "objects": [
    {
      "attributes": {
        "description": "",
        "hits": 0,
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": {
            "filter": [],
            "query": {
              "language": "kuery",
              "query": ""
            }
          }
        },
        "optionsJSON": {
          "hidePanelTitles": false,
          "useMargins": true
        },
        "panelsJSON": [
          {
            "embeddableConfig": {},
            "gridData": {
              "h": 15,
              "i": "ec36b04f-b714-401a-a4c6-3212ca615592",
              "w": 23,
              "x": 0,
              "y": 0
            },
            "panelIndex": "ec36b04f-b714-401a-a4c6-3212ca615592",
            "panelRefName": "panel_0",
            "version": "7.9.2"
          },
          {
            "embeddableConfig": {},
            "gridData": {
              "h": 15,
              "i": "37af54a7-99cb-41da-b00e-b5aebcd93e8b",
              "w": 25,
              "x": 23,
              "y": 0
            },
            "panelIndex": "37af54a7-99cb-41da-b00e-b5aebcd93e8b",
            "panelRefName": "panel_1",
            "version": "7.9.2"
          },
          {
            "embeddableConfig": {},
            "gridData": {
              "h": 18,
              "i": "e83917f5-d17a-4e09-a553-c996a57b4739",
              "w": 17,
              "x": 0,
              "y": 15
            },
            "panelIndex": "e83917f5-d17a-4e09-a553-c996a57b4739",
            "panelRefName": "panel_2",
            "version": "7.9.2"
          },
          {
            "embeddableConfig": {},
            "gridData": {
              "h": 18,
              "i": "46e12b30-e4dd-462f-b59f-48c88300a89e",
              "w": 12,
              "x": 17,
              "y": 15
            },
            "panelIndex": "46e12b30-e4dd-462f-b59f-48c88300a89e",
            "panelRefName": "panel_3",
            "version": "7.9.2"
          },
          {
            "embeddableConfig": {},
            "gridData": {
              "h": 18,
              "i": "1096fbd8-383b-4d8d-9582-dac41270475f",
              "w": 19,
              "x": 29,
              "y": 15
            },
            "panelIndex": "1096fbd8-383b-4d8d-9582-dac41270475f",
            "panelRefName": "panel_4",
            "version": "7.9.2"
          },
          {
            "embeddableConfig": {
              "hiddenLayers": [],
              "isLayerTOCOpen": false,
              "mapCenter": {
                "lat": 20.2912,
                "lon": 14.61228,
                "zoom": 1.32
              },
              "openTOCDetails": []
            },
            "gridData": {
              "h": 17,
              "i": "c2fafd37-cbb9-48fd-ad21-76f2c57a4a0c",
              "w": 31,
              "x": 0,
              "y": 33
            },
            "panelIndex": "c2fafd37-cbb9-48fd-ad21-76f2c57a4a0c",
            "panelRefName": "panel_5",
            "version": "7.9.2"
          },
          {
            "embeddableConfig": {},
            "gridData": {
              "h": 17,
              "i": "4130c0b5-c2af-4ded-9406-0b7d477c202d",
              "w": 17,
              "x": 31,
              "y": 33
            },
            "panelIndex": "4130c0b5-c2af-4ded-9406-0b7d477c202d",
            "panelRefName": "panel_6",
            "version": "7.9.2"
          },
          {
            "embeddableConfig": {},
            "gridData": {
              "h": 15,
              "i": "70185726-7b35-4f2d-ab07-60c719705373",
              "w": 48,
              "x": 0,
              "y": 50
            },
            "panelIndex": "70185726-7b35-4f2d-ab07-60c719705373",
            "panelRefName": "panel_7",
            "version": "7.9.2"
          }
        ],
        "timeRestore": false,
        "title": "[VirusTotal] Livehunt Overview",
        "version": 1
      },
      "id": "bd059c90-0e56-11eb-9aef-8b55a4ae31c5",
      "migrationVersion": {
        "dashboard": "7.3.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "8901bc70-0fe2-11eb-9aef-8b55a4ae31c5",
          "name": "panel_0",
          "type": "visualization"
        },
        {
          "id": "502946c0-0fe2-11eb-9aef-8b55a4ae31c5",
          "name": "panel_1",
          "type": "visualization"
        },
        {
          "id": "32ad8fe0-0e50-11eb-9aef-8b55a4ae31c5",
          "name": "panel_2",
          "type": "visualization"
        },
        {
          "id": "a3cfa7a0-0fe3-11eb-9aef-8b55a4ae31c5",
          "name": "panel_3",
          "type": "visualization"
        },
        {
          "id": "1fed6b80-0cd6-11eb-9aef-8b55a4ae31c5",
          "name": "panel_4",
          "type": "visualization"
        },
        {
          "id": "506466e0-0d64-11eb-9aef-8b55a4ae31c5",
          "name": "panel_5",
          "type": "map"
        },
        {
          "id": "3429d920-0caf-11eb-9aef-8b55a4ae31c5",
          "name": "panel_6",
          "type": "visualization"
        },
        {
          "id": "e906a5b0-0fe0-11eb-9aef-8b55a4ae31c5",
          "name": "panel_7",
          "type": "search"
        }
      ],
      "type": "dashboard",
      "updated_at": "2020-10-19T18:41:36.890Z",
      "version": "WzE3NjYxLDFd"
    },
    {
      "attributes": {
        "description": "",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": {
            "filter": [],
            "query": {
              "language": "kuery",
              "query": ""
            }
          }
        },
        "savedSearchRefName": "search_0",
        "title": "Livehunt notifications by ruleset over time [Virustotal Filebeat]",
        "uiStateJSON": {},
        "version": 1,
        "visState": {
          "aggs": [
            {
              "enabled": true,
              "id": "1",
              "params": {},
              "schema": "metric",
              "type": "count"
            },
            {
              "enabled": true,
              "id": "2",
              "params": {
                "drop_partials": false,
                "extended_bounds": {},
                "field": "@timestamp",
                "interval": "auto",
                "min_doc_count": 1,
                "scaleMetricValues": false,
                "timeRange": {
                  "from": "now-2w",
                  "to": "now"
                },
                "useNormalizedEsInterval": true
              },
              "schema": "segment",
              "type": "date_histogram"
            },
            {
              "enabled": true,
              "id": "3",
              "params": {
                "field": "rule.ruleset",
                "missingBucket": false,
                "missingBucketLabel": "Missing",
                "order": "desc",
                "orderBy": "1",
                "otherBucket": true,
                "otherBucketLabel": "Other",
                "size": 9
              },
              "schema": "group",
              "type": "terms"
            }
          ],
          "params": {
            "addLegend": true,
            "addTimeMarker": true,
            "addTooltip": true,
            "categoryAxes": [
              {
                "id": "CategoryAxis-1",
                "labels": {
                  "filter": true,
                  "show": true,
                  "truncate": 100
                },
                "position": "bottom",
                "scale": {
                  "type": "linear"
                },
                "show": true,
                "style": {},
                "title": {},
                "type": "category"
              }
            ],
            "grid": {
              "categoryLines": false
            },
            "labels": {
              "show": false
            },
            "legendPosition": "right",
            "seriesParams": [
              {
                "data": {
                  "id": "1",
                  "label": "Count"
                },
                "drawLinesBetweenPoints": true,
                "interpolate": "linear",
                "lineWidth": 2,
                "mode": "stacked",
                "show": true,
                "showCircles": true,
                "type": "histogram",
                "valueAxis": "ValueAxis-1"
              }
            ],
            "thresholdLine": {
              "color": "#E7664C",
              "show": false,
              "style": "full",
              "value": 10,
              "width": 1
            },
            "times": [],
            "type": "histogram",
            "valueAxes": [
              {
                "id": "ValueAxis-1",
                "labels": {
                  "filter": false,
                  "rotate": 0,
                  "show": true,
                  "truncate": 100
                },
                "name": "LeftAxis-1",
                "position": "left",
                "scale": {
                  "mode": "normal",
                  "type": "linear"
                },
                "show": true,
                "style": {},
                "title": {
                  "text": "Count"
                },
                "type": "value"
              }
            ]
          },
          "title": "Livehunt notifications by ruleset over time [Virustotal Filebeat]",
          "type": "histogram"
        }
      },
      "id": "8901bc70-0fe2-11eb-9aef-8b55a4ae31c5",
      "migrationVersion": {
        "visualization": "7.8.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "e906a5b0-0fe0-11eb-9aef-8b55a4ae31c5",
          "name": "search_0",
          "type": "search"
        }
      ],
      "type": "visualization",
      "updated_at": "2020-10-16T19:10:21.402Z",
      "version": "WzE2OTg1LDFd"
    },
    {
      "attributes": {
        "description": "",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": {
            "filter": [],
            "query": {
              "language": "kuery",
              "query": ""
            }
          }
        },
        "savedSearchRefName": "search_0",
        "title": "Livehunt notifications by type tag over time [Virustotal Filebeat]",
        "uiStateJSON": {},
        "version": 1,
        "visState": {
          "aggs": [
            {
              "enabled": true,
              "id": "1",
              "params": {},
              "schema": "metric",
              "type": "count"
            },
            {
              "enabled": true,
              "id": "2",
              "params": {
                "drop_partials": false,
                "extended_bounds": {},
                "field": "@timestamp",
                "interval": "auto",
                "min_doc_count": 1,
                "scaleMetricValues": false,
                "timeRange": {
                  "from": "now-2w",
                  "to": "now"
                },
                "useNormalizedEsInterval": true
              },
              "schema": "segment",
              "type": "date_histogram"
            },
            {
              "enabled": true,
              "id": "3",
              "params": {
                "field": "virustotal.type_tag",
                "missingBucket": false,
                "missingBucketLabel": "Missing",
                "order": "desc",
                "orderBy": "1",
                "otherBucket": true,
                "otherBucketLabel": "Other",
                "size": 5
              },
              "schema": "group",
              "type": "terms"
            }
          ],
          "params": {
            "addLegend": true,
            "addTimeMarker": true,
            "addTooltip": true,
            "categoryAxes": [
              {
                "id": "CategoryAxis-1",
                "labels": {
                  "filter": true,
                  "show": true,
                  "truncate": 100
                },
                "position": "bottom",
                "scale": {
                  "type": "linear"
                },
                "show": true,
                "style": {},
                "title": {},
                "type": "category"
              }
            ],
            "grid": {
              "categoryLines": false
            },
            "labels": {
              "show": false
            },
            "legendPosition": "right",
            "seriesParams": [
              {
                "data": {
                  "id": "1",
                  "label": "Count"
                },
                "drawLinesBetweenPoints": true,
                "interpolate": "linear",
                "lineWidth": 2,
                "mode": "stacked",
                "show": true,
                "showCircles": true,
                "type": "histogram",
                "valueAxis": "ValueAxis-1"
              }
            ],
            "thresholdLine": {
              "color": "#E7664C",
              "show": false,
              "style": "full",
              "value": 10,
              "width": 1
            },
            "times": [],
            "type": "histogram",
            "valueAxes": [
              {
                "id": "ValueAxis-1",
                "labels": {
                  "filter": false,
                  "rotate": 0,
                  "show": true,
                  "truncate": 100
                },
                "name": "LeftAxis-1",
                "position": "left",
                "scale": {
                  "mode": "normal",
                  "type": "linear"
                },
                "show": true,
                "style": {},
                "title": {
                  "text": "Count"
                },
                "type": "value"
              }
            ]
          },
          "title": "Livehunt notifications by type tag over time [Virustotal Filebeat]",
          "type": "histogram"
        }
      },
      "id": "502946c0-0fe2-11eb-9aef-8b55a4ae31c5",
      "migrationVersion": {
        "visualization": "7.8.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "e906a5b0-0fe0-11eb-9aef-8b55a4ae31c5",
          "name": "search_0",
          "type": "search"
        }
      ],
      "type": "visualization",
      "updated_at": "2020-10-16T19:09:35.807Z",
      "version": "WzE2OTgwLDFd"
    },
    {
      "attributes": {
        "description": "",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": {
            "filter": [],
            "query": {
              "language": "kuery",
              "query": ""
            }
          }
        },
        "title": "Analysis Results Wordcloud [Virustotal Filebeat] ",
        "uiStateJSON": {},
        "version": 1,
        "visState": {
          "aggs": [],
          "params": {
            "spec": "{\n  $schema: \"https://vega.github.io/schema/vega/v5.json\"\n  data: [\n    {\n      name: engines\n      url: {\n        %context%: true\n        %timefield%: @timestamp\n        index: \"filebeat-*\"\n        body: {\n          aggs: {\n            engines: {\n              nested: {\n                path: \"virustotal.analysis.results\"\n              },\n              aggs: {\n                values: {\n                  terms: {\n                    size: 100\n                    field: \"virustotal.analysis.results.result\" \n                  }\n                }\n              }\n            }\n          }\n          size: 0\n        }\n      }\n      format: { property: \"aggregations.engines.values.buckets\" }\n      transform: [\n        {\n          \"type\": \"formula\", \"as\": \"angle\",\n          \"expr\": \"0\"\n        },\n        {\n          \"type\": \"formula\", \"as\": \"weight\",\n          \"expr\": \"datum.doc_count\"\n        }\n      ]\n    }\n  ]\n  \n  \"signals\": [\n    {\n      \"name\": \"wordclick\",\n      \"value\": \"\",\n      \"on\": [\n        {\n          \"events\": \"text:click\",\n          \"update\": '''\n          kibanaAddFilter({\"nested\": {\"path\": \"virustotal.analysis.results\", \"query\": {\"bool\": {\"must\": [{ \"match\": { \"virustotal.analysis.results.result\":  event.item.text  } }]}}}})\n          '''\n        }\n      ]\n    }\n  ]\n\n  scales: [\n    {\n      name: \"color\"\n      type: \"ordinal\"\n      domain: { data: \"engines\", field: \"key\" }\n      range: {\"scheme\": \"elastic\"}\n    }\n  ]\n\n  marks: [\n    {\n      name: cloud\n      type: text\n      from: {data: \"engines\"}\n      encode: {\n        enter: {\n          text: {field: \"key\"}\n          align: {value: \"center\"}\n          baseline: {value: \"alphabetic\"}\n          fill: {scale: \"color\", field: \"key\"}\n        },\n        update: {\n          fillOpacity: {value: 1}\n        },\n        hover: {\n          fillOpacity: {value: 0.5}\n        }\n\n      }\n      transform: [\n        {\n          type: wordcloud\n          text: {field: \"datum.key\"}\n          size: [{signal: \"width\"}, {signal: \"height\"}],\n          rotate: {field: \"datum.angle\"}\n          font: \"Helvetica Neue, Arial\"\n          fontSize: {field: \"datum.doc_count\"}\n          fontWeight: {field: \"datum.weight\"}\n          fontSizeRange: [8, 72]\n          padding: 4\n        }\n      ]\n    }\n\n  ]\n}"
          },
          "title": "Analysis Results Wordcloud [Virustotal Filebeat] ",
          "type": "vega"
        }
      },
      "id": "32ad8fe0-0e50-11eb-9aef-8b55a4ae31c5",
      "migrationVersion": {
        "visualization": "7.8.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [],
      "type": "visualization",
      "updated_at": "2020-10-16T21:39:56.735Z",
      "version": "WzE3Mjk4LDFd"
    },
    {
      "attributes": {
        "description": "",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": {
            "filter": [],
            "query": {
              "language": "kuery",
              "query": ""
            }
          }
        },
        "savedSearchRefName": "search_0",
        "title": "Livehunt notifications by mime-type [Virustotal FIlebeat]",
        "uiStateJSON": {
          "vis": {
            "params": {
              "sort": {
                "columnIndex": null,
                "direction": null
              }
            }
          }
        },
        "version": 1,
        "visState": {
          "aggs": [
            {
              "enabled": true,
              "id": "1",
              "params": {},
              "schema": "metric",
              "type": "count"
            },
            {
              "enabled": true,
              "id": "2",
              "params": {
                "customLabel": "MIME Type",
                "field": "file.mime_type",
                "missingBucket": false,
                "missingBucketLabel": "Missing",
                "order": "desc",
                "orderBy": "1",
                "otherBucket": true,
                "otherBucketLabel": "Other",
                "size": 9
              },
              "schema": "bucket",
              "type": "terms"
            }
          ],
          "params": {
            "perPage": 10,
            "percentageCol": "",
            "showMetricsAtAllLevels": false,
            "showPartialRows": false,
            "showTotal": false,
            "sort": {
              "columnIndex": null,
              "direction": null
            },
            "totalFunc": "sum"
          },
          "title": "Livehunt notifications by mime-type [Virustotal FIlebeat]",
          "type": "table"
        }
      },
      "id": "a3cfa7a0-0fe3-11eb-9aef-8b55a4ae31c5",
      "migrationVersion": {
        "visualization": "7.8.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "e906a5b0-0fe0-11eb-9aef-8b55a4ae31c5",
          "name": "search_0",
          "type": "search"
        }
      ],
      "type": "visualization",
      "updated_at": "2020-10-16T19:13:14.522Z",
      "version": "WzE2OTk2LDFd"
    },
    {
      "attributes": {
        "description": "",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": {
            "filter": [],
            "indexRefName": "kibanaSavedObjectMeta.searchSourceJSON.index",
            "query": {
              "language": "kuery",
              "query": ""
            }
          }
        },
        "title": "File Capabilities Word Cloud [Virustotal Filebeat]",
        "uiStateJSON": {},
        "version": 1,
        "visState": {
          "aggs": [
            {
              "enabled": true,
              "id": "1",
              "params": {},
              "schema": "metric",
              "type": "count"
            },
            {
              "enabled": true,
              "id": "2",
              "params": {
                "field": "virustotal.capabilities",
                "missingBucket": false,
                "missingBucketLabel": "Missing",
                "order": "desc",
                "orderBy": "1",
                "otherBucket": false,
                "otherBucketLabel": "Other",
                "size": 100
              },
              "schema": "segment",
              "type": "terms"
            }
          ],
          "params": {
            "maxFontSize": 72,
            "minFontSize": 18,
            "orientation": "single",
            "scale": "linear",
            "showLabel": true
          },
          "title": "File Capabilities Word Cloud [Virustotal Filebeat]",
          "type": "tagcloud"
        }
      },
      "id": "1fed6b80-0cd6-11eb-9aef-8b55a4ae31c5",
      "migrationVersion": {
        "visualization": "7.8.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "filebeat-*",
          "name": "kibanaSavedObjectMeta.searchSourceJSON.index",
          "type": "index-pattern"
        }
      ],
      "type": "visualization",
      "updated_at": "2020-10-16T19:06:05.296Z",
      "version": "WzE2OTY2LDFd"
    },
    {
      "attributes": {
        "description": "",
        "layerListJSON": "[{\"sourceDescriptor\":{\"type\":\"EMS_TMS\",\"id\":\"road_map_desaturated\",\"isAutoSelect\":false},\"id\":\"6a988e7a-8078-4986-a10d-11f388582582\",\"label\":\"Base Map\",\"minZoom\":0,\"maxZoom\":24,\"alpha\":1,\"visible\":true,\"style\":{\"type\":\"TILE\"},\"type\":\"VECTOR_TILE\"},{\"sourceDescriptor\":{\"type\":\"EMS_FILE\",\"id\":\"world_countries\",\"tooltipProperties\":[\"name\"]},\"id\":\"45ea51fa-2c06-4a28-91df-7c393a9186e9\",\"label\":\"Submission Country\",\"minZoom\":0,\"maxZoom\":24,\"alpha\":0.49,\"visible\":true,\"style\":{\"type\":\"VECTOR\",\"properties\":{\"icon\":{\"type\":\"STATIC\",\"options\":{\"value\":\"marker\"}},\"fillColor\":{\"type\":\"DYNAMIC\",\"options\":{\"color\":\"Blues\",\"colorCategory\":\"palette_0\",\"field\":{\"name\":\"__kbnjoin__count__b0962d51-63b7-46a2-9be3-5b5de3db8eff\",\"origin\":\"join\"},\"fieldMetaOptions\":{\"isEnabled\":true,\"sigma\":3},\"type\":\"ORDINAL\",\"useCustomColorRamp\":false}},\"lineColor\":{\"type\":\"STATIC\",\"options\":{\"color\":\"#000\"}},\"lineWidth\":{\"type\":\"STATIC\",\"options\":{\"size\":1}},\"iconSize\":{\"type\":\"STATIC\",\"options\":{\"size\":6}},\"iconOrientation\":{\"type\":\"STATIC\",\"options\":{\"orientation\":0}},\"labelText\":{\"type\":\"STATIC\",\"options\":{\"value\":\"\"}},\"labelColor\":{\"type\":\"STATIC\",\"options\":{\"color\":\"#000000\"}},\"labelSize\":{\"type\":\"STATIC\",\"options\":{\"size\":14}},\"labelBorderColor\":{\"type\":\"STATIC\",\"options\":{\"color\":\"#FFFFFF\"}},\"symbolizeAs\":{\"options\":{\"value\":\"circle\"}},\"labelBorderSize\":{\"options\":{\"size\":\"SMALL\"}}},\"isTimeAware\":true},\"type\":\"VECTOR\",\"joins\":[{\"leftField\":\"iso2\",\"right\":{\"id\":\"b0962d51-63b7-46a2-9be3-5b5de3db8eff\",\"indexPatternTitle\":\"filebeat-*\",\"term\":\"virustotal.submission.source.geo.country_iso_code\",\"indexPatternRefName\":\"layer_1_join_0_index_pattern\"}}]}]",
        "mapStateJSON": "{\"zoom\":1.77,\"center\":{\"lon\":0,\"lat\":0},\"timeFilters\":{\"from\":\"now-14d\",\"to\":\"now\"},\"refreshConfig\":{\"isPaused\":true,\"interval\":0},\"query\":{\"query\":\"\",\"language\":\"kuery\"},\"filters\":[{\"meta\":{\"index\":\"filebeat-*\",\"alias\":null,\"negate\":false,\"disabled\":false,\"type\":\"exists\",\"key\":\"virustotal.id\",\"value\":\"exists\"},\"exists\":{\"field\":\"virustotal.id\"},\"$state\":{\"store\":\"appState\"}}],\"settings\":{\"initialLocation\":\"LAST_SAVED_LOCATION\",\"fixedLocation\":{\"lat\":0,\"lon\":0,\"zoom\":2},\"browserLocation\":{\"zoom\":2},\"maxZoom\":24,\"minZoom\":0,\"showSpatialFilters\":true,\"spatialFiltersAlpa\":0.88,\"spatialFiltersFillColor\":\"#DA8B45\",\"spatialFiltersLineColor\":\"#DA8B45\"}}",
        "title": "[Virustotal] Submission Country",
        "uiStateJSON": {
          "isLayerTOCOpen": false,
          "openTOCDetails": []
        }
      },
      "id": "506466e0-0d64-11eb-9aef-8b55a4ae31c5",
      "migrationVersion": {
        "map": "7.9.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "filebeat-*",
          "name": "layer_1_join_0_index_pattern",
          "type": "index-pattern"
        }
      ],
      "type": "map",
      "updated_at": "2020-10-14T19:16:25.908Z",
      "version": "WzE2NTEzLDFd"
    },
    {
      "attributes": {
        "description": "",
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": {
            "filter": [],
            "query": {
              "language": "kuery",
              "query": ""
            }
          }
        },
        "title": "Detection Counts By Engine [VirusTotal Filebeat] ",
        "uiStateJSON": {},
        "version": 1,
        "visState": {
          "aggs": [],
          "params": {
            "spec": "{\n  $schema: https://vega.github.io/schema/vega-lite/v4.json\n  title: Event counts from all indexes\n  // Define the data source\n  data: {\n    url: {\n      // Apply dashboard context filters when set\n      %context%: true\n      // Filter the time picker (upper right corner) with this field\n      %timefield%: @timestamp\n\n      // Which index to search\n      index: filebeat-8.0.0\n      body: {\n        size: 0\n        aggs: {\n          \"results\": {\n            \"nested\": {\n              \"path\": \"virustotal.analysis.results\"\n            },\n            \"aggs\": {\n              \"table\": {\n                \"composite\": {\n                  \"size\": 1000,\n                  \"sources\": [\n                    {\"engine_name\": {\"terms\": {\"field\": \"virustotal.analysis.results.engine_name\"}}},\n                    {\"category\": {\"terms\": {\"field\": \"virustotal.analysis.results.category\"}}}\n                  ]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n    name: kibana\n\n    // From the result, take just the data we are interested in\n    format: {\n      property: aggregations.results.table.buckets\n    }\n    // Convert key.stk1 -\u003e stk1 for simpler access below\n    transform: [\n      {\n        type: formula\n        expr: datum.key.engine_name\n        as: engine_name\n      }\n      {\n        type: formula\n        expr: datum.key.category\n        as: category\n      }\n      {\n        type: formula\n        expr: datum.doc_count\n        as: count\n      }\n    ]\n  }\n\n  // \"mark\" is the graphics element used to show our data.  Other mark values are: area, bar, circle, line, point, rect, rule, square, text, and tick.  See https://vega.github.io/vega-lite/docs/mark.html\n  mark: text\n\n  // \"encoding\" tells the \"mark\" what data to use and in what way.  See https://vega.github.io/vega-lite/docs/encoding.html\n  encoding: {\n    x: {\n      // The \"key\" value is the timestamp in milliseconds.  Use it for X axis.\n      field: key.category\n      type: ordinal\n      axis: {\n        title: Category\n      } // Customize X axis format\n    }\n    y: {\n      // The \"doc_count\" is the count per bucket.  Use it for Y axis.\n      field: key.engine_name\n      type: ordinal\n      axis: {\n        title: Engine Name\n      }\n    }\n  }\n  layer: [\n    {\n      \"mark\": \"rect\",\n      \"encoding\": {\n        \"color\": {\n          \"field\": \"doc_count\",\n          \"type\": \"quantitative\",\n          \"title\": \"Count of Records\",\n          \"legend\": {\"direction\": \"horizontal\", \"gradientLength\": 120}\n        }\n      }\n    },\n    {\n      mark: text\n      encoding: {\n        text: {\n          field: doc_count\n          type: quantitative\n        }\n        \"color\": {\n          \"condition\": {\"test\": \"datum['doc_count'] \u003c 40\", \"value\": \"black\"},\n          \"value\": \"white\"\n        }\n      }\n    }\n  ]\n  config: {\n    axis: {\n      grid: true\n      tickBand: extent\n    }\n  }\n}"
          },
          "title": "Detection Counts By Engine [VirusTotal Filebeat] ",
          "type": "vega"
        }
      },
      "id": "3429d920-0caf-11eb-9aef-8b55a4ae31c5",
      "migrationVersion": {
        "visualization": "7.8.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [],
      "type": "visualization",
      "updated_at": "2020-10-16T18:55:10.043Z",
      "version": "WzE2ODk5LDFd"
    },
    {
      "attributes": {
        "columns": [
          "file.hash.sha1",
          "file.name",
          "file.size",
          "file.mime_type",
          "rule.ruleset",
          "rule.name",
          "rule.tags",
          "virustotal.capabilities",
          "virustotal.type_description"
        ],
        "description": "",
        "hits": 0,
        "kibanaSavedObjectMeta": {
          "searchSourceJSON": {
            "filter": [
              {
                "$state": {
                  "store": "appState"
                },
                "exists": {
                  "field": "virustotal.id"
                },
                "meta": {
                  "alias": null,
                  "disabled": false,
                  "indexRefName": "kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
                  "key": "virustotal.id",
                  "negate": false,
                  "type": "exists",
                  "value": "exists"
                }
              }
            ],
            "highlightAll": true,
            "indexRefName": "kibanaSavedObjectMeta.searchSourceJSON.index",
            "query": {
              "language": "kuery",
              "query": ""
            },
            "version": true
          }
        },
        "sort": [],
        "title": "Virustotal LiveHunt Files",
        "version": 1
      },
      "id": "e906a5b0-0fe0-11eb-9aef-8b55a4ae31c5",
      "migrationVersion": {
        "search": "7.4.0"
      },
      "namespaces": [
        "default"
      ],
      "references": [
        {
          "id": "filebeat-*",
          "name": "kibanaSavedObjectMeta.searchSourceJSON.index",
          "type": "index-pattern"
        },
        {
          "id": "filebeat-*",
          "name": "kibanaSavedObjectMeta.searchSourceJSON.filter[0].meta.index",
          "type": "index-pattern"
        }
      ],
      "type": "search",
      "updated_at": "2020-10-16T18:53:42.155Z",
      "version": "WzE2ODkwLDFd"
    }
  ],
  "version": "7.9.2"
}